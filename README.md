# Экспорт динамических блоков AutoCAD в YAML

## Описание проекта
Этот скрипт AutoLISP предназначен для экспорта информации о динамических блоках из чертежа AutoCAD в файл формата YAML. Скрипт собирает следующие данные:
- Основные параметры блоков (имя, координаты, слой)
- Атрибуты блоков
- Динамические свойства блоков

## Особенности
- Поддержка специфичных блоков (фильтрация по именам)
- Экспорт в удобочитаемый YAML-формат
- Измерение времени выполнения
- Логирование процесса обработки

## Установка
1. Скопируйте код в файл с расширением `.lsp`
2. Загрузите в AutoCAD через:
   - `APPLOAD` (графический интерфейс)
   - `(load "путь/к/файлу.lsp")` (в командной строке)

## Использование
Введите команду в AutoCAD:
```
ExportDynamicBlockToyaml
```

Результат будет сохранен в файл с тем же именем, что и чертеж, но с расширением `.yaml` в той же папке.

## Формат выходного файла
Пример структуры YAML:
```yaml
- Handle: '123'
  Block Name: 'MyBlock'
  Real Name: 'MyRealBlock'
  X: '100.0000'
  Y: '200.0000'
  Z: '0.0000'
  Layer: 'MyLayer'
  Attribs:
    ATTR1: 'Value1'
    ATTR2: 'Value2'
  Properties:
    Width: '50'
    Height: '100'
```

## Ограничения
1. Обрабатываются только динамические блоки
2. Поддерживаются только определенные имена блоков (см. функцию `is-my-block`)
3. Некоторые свойства исключены из экспорта (см. `good-property`)

## Структура кода
### Основные функции
- `ExportDynamicBlockToyaml` - главная функция экспорта
- `export-blocks-to-yaml` - основной процесс экспорта
- `process-blocks` - обработка всех блоков в чертеже

### Вспомогательные функции
- Получение данных блока:
  - `get-block-*` - координаты, поворот, handle
  - `get-realName` - получение реального имени блока
  - `get-*Values` - получение атрибутов и свойств

- Экспорт данных:
  - `export-block-commonData` - основные параметры
  - `export-block-attribs` - атрибуты
  - `export-block-properties` - динамические свойства

### Утилиты
- `is-dynamic-block` - проверка типа блока
- `is-my-block` - фильтр по именам блоков
- `good-property` - фильтр свойств для экспорта

## Требования
- AutoCAD с поддержкой AutoLISP и Visual LISP (VLIDE)
- Доступ на запись в папку с чертежом

## Лицензия
[MIT License](LICENSE)

---

Для более подробной информации см. комментарии в исходном коде.
